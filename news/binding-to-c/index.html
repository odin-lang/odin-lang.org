<!doctype html><html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=/favicon.svg><meta name=color-scheme content="only dark"><meta property="og:title" content="Binding to C"><meta property="og:description" content="Using Odin to bind to C and other foreign languages"><meta property="og:type" content="article"><meta property="og:url" content="https://odin-lang.org/news/binding-to-c/"><meta property="og:image" content="https://odin-lang.org/images/logo-slim.png"><meta property="article:published_time" content="2022-07-17T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-17T00:00:00+00:00"><link rel=stylesheet href=https://odin-lang.org/scss/custom.min.css><link rel=stylesheet href=/lib/highlight/styles/github-dark.min.css><script src=/lib/highlight/highlight.min.js></script><script>hljs.registerLanguage("odin",function(e){return{aliases:["odin","odinlang","odin-lang"],keywords:{keyword:"auto_cast bit_field bit_set break case cast context continue defer distinct do dynamic else enum fallthrough for foreign if import in map matrix not_in or_else or_return package proc return struct switch transmute type_of typeid union using when where",literal:"true false nil",built_in:"abs align_of cap clamp complex conj expand_to_tuple imag jmag kmag len max min offset_of quaternion real size_of soa_unzip soa_zip swizzle type_info_of type_of typeid_of"},illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,{begin:"'",end:"[^\\\\]'"},{begin:"`",end:"`"}]},{className:"number",variants:[{begin:e.C_NUMBER_RE+"[ijk]",relevance:1},e.C_NUMBER_MODE]}]}})</script><script>hljs.highlightAll()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-67516878-2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-67516878-2")</script><link href=/css/style.css rel=stylesheet><title>Binding to C | Odin Programming Language </title><link rel=alternate type=application/rss+xml href=https://odin-lang.org//categories/newsletter/index.xml title="Odin Newsletter"><body data-bs-spy=scroll data-bs-target=#TOC data-bs-offset=0 tabindex=0><script>window.localStorage.getItem("theme")||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(window.localStorage.setItem("theme","dark"),document.body.classList.add("dark-mode")),window.localStorage.getItem("theme")==="dark"&&document.body.classList.add("dark-mode");function toggleDarkMode(){document.body.classList.toggle("dark-mode")?window.localStorage.setItem("theme","dark"):window.localStorage.setItem("theme","light")}</script><header class=sticky-top><nav class="navbar navbar-expand-lg navbar-dark bg-primary odin-menu"><div class=container-xxl><a class=navbar-brand href=/><img src=/logo.svg height=30 alt=Odin id=navbar-logo>
</a><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#odin-navbar-content aria-controls=odin-navbar-content aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=odin-navbar-content><ul class="navbar-nav ms-md-auto"><li class=nav-item><a class=nav-link href=/>Home</a></li><li class=nav-item><a class=nav-link href=/docs>Docs</a></li><li class=nav-item><a class=nav-link href=https://pkg.odin-lang.org/>Packages</a></li><li class=nav-item><a class="nav-link active" href=/news aria-current=page>News</a></li><li class=nav-item><a class=nav-link href=/showcase>Showcase</a></li><li class=nav-item><a class=nav-link href=https://forum.odin-lang.org>Forum</a></li><li class=nav-item><a class=nav-link href=/community>Community</a></li><li class=nav-item><a class=nav-link href=https://github.com/odin-lang/Odin target=_blank>GitHub</a></li><li class=nav-item><a class="nav-link btn-dark-mode" onclick=toggleDarkMode() title="Toggle Light/Dark Mode"><span class=dark-mode-appearance>Appearance:</span><svg fill="#fff" id="dark-mode-icon" viewBox="0 0 384 512"><path d="M223.5 32C1e2 32 0 132.3.0 256S1e2 480 223.5 480c60.6.0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9.0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/></svg><svg fill="#fff" id="light-mode-icon" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8M8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0m0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13m8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5M3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8m10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0m-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0m9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707M4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708"/></svg></button></a></li></ul></div></div></nav></header><main><div class=container-xxl><div class="row odin-main"><nav class="col-lg-2 odin-sidebar-border navbar-light"><div class="sticky-top odin-below-navbar py-3"><ul class="nav nav-pills d-flex flex-column"><li class=nav-item><a class=nav-link href=/news/newsletter-2025-q1/>2025 Q1 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/orca-odin/>Orca Odin Support</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-12/>December 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-10/>October 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-09/>September 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-08/>August 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-07/>July 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-06/>June 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-05/>May 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-04/>April 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-03/>March 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-02/>February 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2024-01/>January 2024 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-12/>December 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-11/>November 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-09/>September 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-08/>August 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-07/>July 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-06/>June 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2023-04/>April 2023 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2022-12/>December 2022 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/newsletter-2022-11/>November 2022 Newsletter</a></li><li class=nav-item><a class=nav-link href=/news/read-a-file-line-by-line/>Reading a File Line by Line</a></li><li class=nav-item><a class=nav-link href=/news/calling-odin-from-python/>Calling Odin from Python</a></li><li class=nav-item><a class="nav-link active" href=/news/binding-to-c/ aria-current=page>Binding to C</a></li><li class=nav-item><a class=nav-link href=/news/declaration-syntax/>Odin's Declaration Syntax</a></li><li class=nav-item><a class=nav-link href=/news/major-graphics-apis/>Official Metal and Direct3D Support</a></li><li class=nav-item><a class=nav-link href=/news/new-package-documentation/>New Package Documentation</a></li><li class=nav-item><a class=nav-link href=/news/optional-semicolons/>Optional Semicolons</a></li><li class=nav-item><a class=nav-link href=/news/quine-in-odin/>A Quine in Odin</a></li></ul></div></nav><article class="col-lg-8 p-4"><header><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=/news>News</a></li><li class=breadcrumb-item><a href=/news/binding-to-c>Binding to c</a></li></ol><h1>Binding to C</h1></header><div class=odin-article><h2 id=binding-to-c>Binding to C <a class=text-decoration-none href=#binding-to-c>#</a></h2><p>Odin makes it fairly easy to bind to C code (but not C++ code, unless wrapped) that is compiled as a local static or dynamic/shared library, or to a system library.</p><p>This is primarily done in two parts, first by using <code>foreign import</code> to create an import name and link to the library file, and <code>foreign</code> blocks to link to declare individual exported functions and variables.</p><p><strong>Note:</strong> Any language that supports C ABI is able to be used with the <code>foreign</code> in Odin.</p><h3 id=example>Example <a class=text-decoration-none href=#example>#</a></h3><p>Make a file called <code>foo.c</code> containing the following:
foo.c:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>foo_add_int</span>(<span style=color:#66d9ef>int</span> a, <span style=color:#66d9ef>int</span> b) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a <span style=color:#f92672>+</span> b;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>foo_add_double</span>(<span style=color:#66d9ef>double</span> a, <span style=color:#66d9ef>double</span> b) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> a <span style=color:#f92672>+</span> b;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>then, depending on your platform:</p><pre tabindex=0><code>gcc -c foo.c
ar rcs foo.a foo.o
</code></pre><pre tabindex=0><code>cl -TC -c foo.c
lib -nologo foo.obj -out:foo.lib
</code></pre><p>And finally, to use it in Odin, you could do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;core:fmt&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> <span style=color:#e6db74>&#34;core:c&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>when</span> ODIN_OS <span style=color:#f92672>==</span> .Windows <span style=color:#66d9ef>do</span> <span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;foo.lib&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>when</span> ODIN_OS <span style=color:#f92672>==</span> .Linux   <span style=color:#66d9ef>do</span> <span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;foo.a&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreign</span> foo {
</span></span><span style=display:flex><span>    foo_add_int    <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.<span style=color:#66d9ef>int</span>)    <span style=color:#f92672>-&gt;</span> c.<span style=color:#66d9ef>int</span> <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>    foo_add_double <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.double) <span style=color:#f92672>-&gt;</span> c.double <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>main <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>() {
</span></span><span style=display:flex><span>    fmt.println(foo_add_int(<span style=color:#a6e22e>2</span>, <span style=color:#a6e22e>2</span>))
</span></span><span style=display:flex><span>    fmt.println(foo_add_double(<span style=color:#a6e22e>2</span><span style=color:#ae81ff>.71828</span>, <span style=color:#a6e22e>3</span><span style=color:#ae81ff>.14159</span>))
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that the procedure declaration has to end in <code>---</code> inside the <code>foreign</code> block to denote that the body is found elsewhere. This is to prevent a parsing ambiguity with procedure variables and types. See the <a href=https://odin-lang.org/docs/overview/#attributes>Attributes and Directives sections</a> for more information.</p><h3 id=foreign-blocks>Foreign blocks <a class=text-decoration-none href=#foreign-blocks>#</a></h3><p>Odin supports multiple ways of making binding to C easier.</p><p>By default, the foreign block links to a function of the same name as the name you specify inside the <code>foreign</code> block. This can be explicitly changed by using the <code>@(link_name=&lt;string>)</code> and <code>@(link_prefix=&lt;string>)</code> <a href=https://odin-lang.org/docs/overview/#linking-and-foreign-attributes>attributes</a>. The following are all equivalent:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#66d9ef>foreign</span> foo {
</span></span><span style=display:flex><span>    foo_add_int    <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.<span style=color:#66d9ef>int</span>)    <span style=color:#f92672>-&gt;</span> c.<span style=color:#66d9ef>int</span> <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>    foo_add_double <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.double) <span style=color:#f92672>-&gt;</span> c.double <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#66d9ef>foreign</span> foo {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@(link_name=&#34;foo_add_int&#34;)</span>
</span></span><span style=display:flex><span>    add_int <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.<span style=color:#66d9ef>int</span>) <span style=color:#f92672>-&gt;</span> c.<span style=color:#66d9ef>int</span> <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@(link_name=&#34;foo_add_double&#34;)</span>
</span></span><span style=display:flex><span>    add_double <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.double) <span style=color:#f92672>-&gt;</span> c.double <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#a6e22e>@(link_prefix=&#34;foo_&#34;)</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreign</span> foo {
</span></span><span style=display:flex><span>    add_int    <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.<span style=color:#66d9ef>int</span>)    <span style=color:#f92672>-&gt;</span> c.<span style=color:#66d9ef>int</span> <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>    add_double <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span>(a, b<span style=color:#f92672>:</span> c.double) <span style=color:#f92672>-&gt;</span> c.double <span style=color:#f92672>---</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=static-vs-shared-libraries>Static vs shared libraries <a class=text-decoration-none href=#static-vs-shared-libraries>#</a></h3><p>Static libraries work the same on every platform: you specify the relative paths of the library file in the .odin file you are importing it to.</p><p>Dynamic/shared libraries are slightly different depending on which operating system you are using:</p><ul><li>In Windows you link to an import lib (.lib) relative to the file you&rsquo;re importing from, and the user has to make sure the corresponding .dll is visible to the exectutable.</li><li>In Linux you link directly to the shared object (.so) that is visible to the executable.</li></ul><p>Note that for local libraries and for system libraries in Windows you need to specify the full filename, including file extension. For system libraries in Linux you can omit the extension, and it will link to the appropriate library file available in the system library search paths.</p><p>To summarize, if the current file is <code>/path/to/file/foo.odin</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;foo.a&#34;</span>          <span style=color:#75715e>// static lib in linux, links to /path/to/file/foo.a
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;foo.so&#34;</span>         <span style=color:#75715e>// shared lib in linux links to /path/to/executable/foo.so
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;foo.lib&#34;</span>        <span style=color:#75715e>// static/import library in windows, links to /path/to/file/foo.lib
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;system:foo&#34;</span>     <span style=color:#75715e>// system library (static or shared) in linux. Links to /usr/lib/libfoo.a
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>foreign</span> <span style=color:#f92672>import</span> foo <span style=color:#e6db74>&#34;system:foo.lib&#34;</span> <span style=color:#75715e>// system library (static or import) in windows. Links to foo.lib
</span></span></span></code></pre></div><h3 id=calling-conventions>Calling conventions <a class=text-decoration-none href=#calling-conventions>#</a></h3><p>C supports a plethora of calling conventions, most of them for Windows. Procedure calling conventions are added after the <code>proc</code> in the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span>foo <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span> <span style=color:#e6db74>&#34;c&#34;</span> () {}
</span></span><span style=display:flex><span>bar <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span> <span style=color:#e6db74>&#34;stdcall&#34;</span> () {}
</span></span><span style=display:flex><span>bar <span style=color:#f92672>::</span> <span style=color:#66d9ef>proc</span> <span style=color:#e6db74>&#34;system&#34;</span> () {} <span style=color:#75715e>// &#34;stdcall&#34; on Windows, &#34;c&#34; on *nix systems
</span></span></span></code></pre></div><p>Procedure declarations in <code>foreign</code> blocks default to the &ldquo;c&rdquo; calling convention, but this can be changed by adding the <code>@(default_calling_convention=&lt;string>)</code> attribute prior to the <code>foreign</code> block.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span><span style=color:#a6e22e>@(default_calling_convention=&#34;std&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>foreign</span> lib {
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Possible calling conventions are:</p><ul><li><code>"odin"</code></li><li><code>"contextless"</code></li><li><code>"c", "cdecl"</code></li><li><code>"std"</code>, <code>"stdcall"</code></li><li><code>"fast"</code>, <code>"fastcall"</code></li><li><code>"system"</code> (system OS default, e.g. <code>"stdcall"</code> on Windows, <code>"c"</code> on *nix systems)</li></ul><h3 id=types>Types <a class=text-decoration-none href=#types>#</a></h3><p>C types don&rsquo;t map directly to Odin types typically, even if they both have types with the same name!
There&rsquo;s a package in the core library (<a href=https://github.com/odin-lang/Odin/blob/master/core/c/c.odin><code>core:c</code></a>) that you can import to get some Odin equivalents of some of the basic C types.</p><p><strong>Please note</strong> that <code>int</code> in Odin is register-wide (e.g. 64-bit on a 64-bit architecture) and NOT equivalent to C&rsquo;s <code>int</code>, please use <code>c.int</code> from <code>core:c</code> if you require that specific type.</p><p>Some types don&rsquo;t fit in this file, though. There are four big ones: strings, structs, unions, and pointers.</p><h4 id=strings>Strings <a class=text-decoration-none href=#strings>#</a></h4><p>C strings are pointers to the first byte in an array of bytes, who&rsquo;s last byte is zero, or <code>NUL</code>. (a.k.a &ldquo;the null terminator.)
The Odin equivalent to this is <code>cstring</code>, which is just a <code>^u8</code> internally (<code>char const *</code>).</p><p>To work with C strings in Odin, it&rsquo;s highly recommended that you use this type, and, as required, convert them to <code>string</code> with a cast: <code>string(my_cstring)</code> or <code>cast(string) my_cstring</code>, which creates a string that just points to the <code>cstring</code>&rsquo;s data. No allocation or copy is performed.
Despite being just a cast, this takes <code>O(N)</code> time as it will scan the memory, looking for the null terminator, in order to determine the length of the string, since Odin strings keep track of the length.</p><p>To go the other way, you may import <code>core:strings</code> and use <code>strings.clone_to_cstring(my_string)</code>, which makes a copy of the underlying string, and puts a null terminator on the end.
The returned <code>cstring</code> is allocated and so therefore should be freed once you no longer need it.</p><p>Rather than a dynamic allocation, you might alternatively want to use <code>strings.clone_to_cstring(my_string, context.temp_allocator)</code> to use temporary storage instead.</p><h4 id=structs>Structs <a class=text-decoration-none href=#structs>#</a></h4><p>Odin structs with fields that are the same size as their C equivalents, (see <a href=https://github.com/odin-lang/Odin/blob/master/core/c/c.odin><code>core:c</code></a>) Odin structs have the same layout as the equivalent C struct. <em>Please note</em> that structs initialized from C may not have their padding between fields zeroed unlike Odin. Please take this into consideration when interfacing with foreign code in general.</p><p>Packed structs in Odin work the same as C with compiler extensions, with the <code>#packed</code> tag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span>S <span style=color:#f92672>::</span> <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>#packed</span> { x<span style=color:#f92672>:</span> <span style=color:#66d9ef>i64</span>, y<span style=color:#f92672>:</span> <span style=color:#66d9ef>u8</span> }
</span></span><span style=display:flex><span><span style=color:#a6e22e>#assert</span>(size_of(S) <span style=color:#f92672>==</span> <span style=color:#a6e22e>9</span>)
</span></span></code></pre></div><h4 id=unions>Unions <a class=text-decoration-none href=#unions>#</a></h4><p><code>union</code>s in Odin do not have a compatible data layout to their equivalent C union.
You may still declare such a union however by using a struct with the <code>#raw_union</code> tag.</p><h4 id=pointers>Pointers <a class=text-decoration-none href=#pointers>#</a></h4><p>C&rsquo;s pointers allow for both arithmetic and indexing. Odin has done away for the need for both by providing a much richer type system through actual array types (fixed-arrays, slices, dynamic arrays, etc) and a feature specifically added for interfacing with foreign languages such as C: <a href=/docs/overview/#multi-pointers>multi-pointers</a>.</p><p>Normal pointers in Odin effectively assume to be pointing to a value at an address. Its zero value is <code>nil</code>. These normal pointer types can only be deferenced, and do not support arithmetic nor indexing. For the Odin-like equivalent, that is where multi-pointers come in.</p><p>The equivalent to C&rsquo;s <code>void *</code> is <code>rawptr</code> in Odin.</p><p>Multi-Pointers in Odin are a way to describe foreign (C-like) pointers which act like arrays (pointers that map to multiple items). The type <code>[^]T</code> is a multi-pointer to <code>T</code> value(s). Its zero value is <code>nil</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span>p<span style=color:#f92672>:</span> [<span style=color:#f92672>^</span>]<span style=color:#66d9ef>f32</span>
</span></span></code></pre></div><p>What multi-pointers support:</p><ul><li>Index (without any bounds checking)</li><li>Slicing (bounds checking on if both the low and high operands are given)</li><li>Implicit conversions between <code>^T</code> and <code>[^]T</code></li><li>Implicit conversion to <code>rawptr</code> (like all pointers)</li></ul><p>What multi-pointers DO NOT SUPPORT:</p><ul><li>Dereferencing (which makes it closer to a slim-slice than a pointer)</li></ul><p>The main purpose of this type is to aid with <code>foreign</code> code and act as a way to auto-document functionality and allow for easier transition to Odin code, especially converting pointers into slices.</p><p>The following are the rules for indexing and slicing for multi-pointers, and what type they produce depending on the operands given:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-odin data-lang=odin><span style=display:flex><span>x<span style=color:#f92672>:</span> [<span style=color:#f92672>^</span>]T <span style=color:#f92672>=</span> ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x[i]   <span style=color:#f92672>-&gt;</span> T
</span></span><span style=display:flex><span>x[<span style=color:#f92672>:</span>]   <span style=color:#f92672>-&gt;</span> [<span style=color:#f92672>^</span>]T
</span></span><span style=display:flex><span>x[i<span style=color:#f92672>:</span>]  <span style=color:#f92672>-&gt;</span> [<span style=color:#f92672>^</span>]T
</span></span><span style=display:flex><span>x[<span style=color:#f92672>:</span>n]  <span style=color:#f92672>-&gt;</span> []T
</span></span><span style=display:flex><span>x[i<span style=color:#f92672>:</span>n] <span style=color:#f92672>-&gt;</span> []T
</span></span></code></pre></div><h3 id=learning-more>Learning More <a class=text-decoration-none href=#learning-more>#</a></h3><p>If you want to learn more about how to structure your bindings for foreign code, it is highly recommended to read through the source code many of the packages within the <code>vendor</code> library collection:</p><ul><li>Documentation: <a href=https://pkg.odin-lang.org/vendor/>https://pkg.odin-lang.org/vendor/</a></li><li>Source Code: <a href=https://github.com/odin-lang/Odin/tree/master/vendor>https://github.com/odin-lang/Odin/tree/master/vendor</a></li></ul></div></article><div id=TOC class="col-lg-2 odin-toc-border"><div class="sticky-top odin-below-navbar py-3"><nav id=TableOfContents><ul><li><a href=#binding-to-c>Binding to C</a><ul><li><a href=#example>Example</a></li><li><a href=#foreign-blocks>Foreign blocks</a></li><li><a href=#static-vs-shared-libraries>Static vs shared libraries</a></li><li><a href=#calling-conventions>Calling conventions</a></li><li><a href=#types>Types</a><ul><li><a href=#strings>Strings</a></li><li><a href=#structs>Structs</a></li><li><a href=#unions>Unions</a></li><li><a href=#pointers>Pointers</a></li></ul></li><li><a href=#learning-more>Learning More</a></li></ul></li></ul></nav></div></div></div></div></main><footer class=odin-footer><div class="container pb-5 pt-5"><div class="row g-4"><div class=col><a class=navbar-brand href=/><img class=mb-3 src=/logo.svg height=30 alt=Odin></a><p>The Data-Oriented Language for Sane Software Development.</p></div><nav class=col-md-auto><h4 class=fw-normal>Resources</h4><ul class=list-unstyled><li><a href=/docs class=link-light>Docs</a></li><li><a href=https://pkg.odin-lang.org/ class=link-light>Packages</a></li><li><a href=/news class=link-light>News</a></li></ul></nav><nav class=col-md-auto><h4 class=fw-normal>Community</h4><ul class=list-unstyled><li><a href=https://github.com/odin-lang/Odin target=_blank class=link-light>GitHub</a></li><li><a href=https://discord.gg/vafXTdubwr target=_blank class=link-light>Discord</a></li><li><a href=https://www.twitch.tv/ginger_bill target=_blank class=link-light>Twitch</a></li><li><a href=https://www.youtube.com/channel/UCUSck1dOH7VKmG4lRW7tZXg target=_blank class=link-light>YouTube</a></li><li><a href=/showcase target=_blank class=link-light>Showcase</a></li></ul></nav><nav class=col-md-auto><h4 class=fw-normal>Contribute</h4><ul class=list-unstyled><li><a href=https://github.com/odin-lang/Odin/issues target=_blank class=link-light>Issues</a></li><li><a href=https://www.patreon.com/gingerbill target=_blank class=link-light>Donate</a></li></ul></nav></div><div class="mt-4 text-muted">© 2016–2024 Ginger Bill</div></div></footer><script src=/lib/bootstrap/js/bootstrap.min.js></script><script src=/js/script.js></script></body></html>