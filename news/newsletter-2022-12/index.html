<!doctype html><html>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=icon href=/favicon.svg>
<meta name=color-scheme content="only dark">
<meta property="og:title" content="December 2022 Newsletter">
<meta property="og:description" content="Release Note Highlights & Interview with Cloin, author of Spall">
<meta property="og:type" content="article">
<meta property="og:url" content="https://odin-lang.org/news/newsletter-2022-12/">
<meta property="og:image" content="https://odin-lang.org/images/logo-slim.png">
<meta property="article:published_time" content="2022-12-07T00:00:00+00:00">
<meta property="article:modified_time" content="2022-12-07T00:00:00+00:00">
<link rel=stylesheet href=https://odin-lang.org/scss/custom.min.css>
<link rel=stylesheet href=/lib/highlight/styles/github-dark.min.css>
<script src=/lib/highlight/highlight.min.js></script>
<script>hljs.registerLanguage("odin",function(a){return{aliases:["odin","odinlang","odin-lang"],keywords:{keyword:"auto_cast bit_field bit_set break case cast context continue defer distinct do dynamic else enum fallthrough for foreign if import in map matrix not_in or_else or_return package proc return struct switch transmute type_of typeid union using when where",literal:"true false nil",built_in:"abs align_of cap clamp complex conj expand_to_tuple imag jmag kmag len max min offset_of quaternion real size_of soa_unzip soa_zip swizzle type_info_of type_of typeid_of"},illegal:"</",contains:[a.C_LINE_COMMENT_MODE,a.C_BLOCK_COMMENT_MODE,{className:"string",variants:[a.QUOTE_STRING_MODE,{begin:"'",end:"[^\\\\]'"},{begin:"`",end:"`"}]},{className:"number",variants:[{begin:a.C_NUMBER_RE+"[ijk]",relevance:1},a.C_NUMBER_MODE]}]}})</script>
<script>hljs.highlightAll()</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-67516878-2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-67516878-2')</script>
<link href=/css/style.css rel=stylesheet>
<title>December 2022 Newsletter | Odin Programming Language </title>
<link rel=alternate type=application/rss+xml href=https://odin-lang.org/categories/newsletter/index.xml title="Odin Newsletter"><body data-bs-spy=scroll data-bs-target=#TOC data-bs-offset=0 tabindex=0>
<script>window.localStorage.getItem("theme")||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(window.localStorage.setItem("theme","dark"),document.body.classList.add("dark-mode")),window.localStorage.getItem("theme")==="dark"&&document.body.classList.add("dark-mode");function toggleDarkMode(){document.body.classList.toggle("dark-mode")?window.localStorage.setItem("theme","dark"):window.localStorage.setItem("theme","light")}</script><header class=sticky-top>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary odin-menu">
<div class=container-xxl>
<a class=navbar-brand href=/>
<img src=/logo.svg height=30 alt=Odin id=navbar-logo>
</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#odin-navbar-content aria-controls=odin-navbar-content aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=odin-navbar-content>
<ul class="navbar-nav ms-md-auto">
<li class=nav-item>
<a class=nav-link href=/>Home</a>
</li>
<li class=nav-item>
<a class=nav-link href=/docs>Docs</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://pkg.odin-lang.org/>Packages</a>
</li>
<li class=nav-item>
<a class="nav-link active" href=/news aria-current=page>News</a>
</li>
<li class=nav-item>
<a class=nav-link href=/showcase>Showcase</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://forum.odin-lang.org>Forum</a>
</li>
<li class=nav-item>
<a class=nav-link href=/community>Community</a>
</li>
<li class=nav-item>
<a class=nav-link href=https://github.com/odin-lang/Odin target=_blank>GitHub</a>
</li>
<li class=nav-item>
<a class="nav-link btn-dark-mode" onclick=toggleDarkMode() title="Toggle Light/Dark Mode">
<span class=dark-mode-appearance>Appearance:</span><svg fill="#fff" id="dark-mode-icon" viewBox="0 0 384 512"><path d="M223.5 32C1e2 32 0 132.3.0 256S1e2 480 223.5 480c60.6.0 115.5-24.2 155.8-63.4 5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6-96.9.0-175.5-78.8-175.5-176 0-65.8 36-123.1 89.3-153.3 6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"/></svg><svg fill="#fff" id="light-mode-icon" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8M8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0m0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13m8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5M3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8m10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0m-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0m9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707M4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708"/></svg>
</button>
</a>
</li>
</ul>
</div>
</div>
</nav>
</header>
<main>
<div class=container-xxl>
<div class="row odin-main">
<nav class="col-lg-2 odin-sidebar-border navbar-light">
<div class="sticky-top odin-below-navbar py-3">
<ul class="nav nav-pills d-flex flex-column">
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-12/>December 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-10/>October 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-09/>September 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-08/>August 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-07/>July 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-06/>June 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-05/>May 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-04/>April 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-03/>March 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-02/>February 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2024-01/>January 2024 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-12/>December 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-11/>November 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-09/>September 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-08/>August 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-07/>July 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-06/>June 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2023-04/>April 2023 Newsletter</a>
</li>
<li class=nav-item>
<a class="nav-link active" href=/news/newsletter-2022-12/ aria-current=page>December 2022 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/newsletter-2022-11/>November 2022 Newsletter</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/read-a-file-line-by-line/>Reading a File Line by Line</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/calling-odin-from-python/>Calling Odin from Python</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/binding-to-c/>Binding to C</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/declaration-syntax/>Odin's Declaration Syntax</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/major-graphics-apis/>Official Metal and Direct3D Support</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/new-package-documentation/>New Package Documentation</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/optional-semicolons/>Optional Semicolons</a>
</li>
<li class=nav-item>
<a class=nav-link href=/news/quine-in-odin/>A Quine in Odin</a>
</li>
</ul>
</div>
</nav>
<article class="col-lg-8 p-4">
<header>
<nav aria-label=breadcrumb>
<ol class=breadcrumb>
<li class=breadcrumb-item><a href=/news>News</a></li>
<li class=breadcrumb-item><a href=/news/newsletter-2022-12>Newsletter 2022 12</a></li>
</ol>
<h1>December 2022 Newsletter</h1>
</header>
<div class=odin-article>
<h2 id=release-note-highlights>Release note highlights <a class=text-decoration-none href=#release-note-highlights>#</a></h2>
<ul>
<li>New <code>map</code> implementation is that high performance, cache-friendly, and uses a open-addressed Robin Hood hash map data structure with various optimizations for Odin
<ul>
<li>Uses a smaller data structure than previously (4 pointers, down from 7)</li>
<li>SOA-based memory layout</li>
<li>Up to 4x-6x faster insertion and lookup on average</li>
<li>Entries are store in non-contiguous cell-layout which means no element straddles across a cache line</li>
<li>Only one allocation per map instead of two (previously hashes and entries)</li>
<li>Allows for calling <code>delete_key</code> whilst iterating across the map</li>
</ul>
</li>
<li>And <a href=https://github.com/odin-lang/Odin/releases/tag/dev-2022-12>much more</a>!</li>
</ul>
<h2 id=interview-with-cloin-author-of-spall>Interview with Cloin, author of spall <a class=text-decoration-none href=#interview-with-cloin-author-of-spall>#</a></h2>
<p>Q: Let&rsquo;s start at the beginning. How did you find out about <a href=https://odin-lang.org/>Odin</a> and what appealed to you about it?</p>
<p>A: It&rsquo;s been so long since I first heard about Odin, I&rsquo;m not sure my memory is entirely accurate, but I remember Bill plonking around with it ~5-6 years ago, as a fun little project. I use a lot of <code>C</code> for little tools and libraries, because I often wind up having to write performance-critical parsers for wonky binary formats. Odin is a huge sigh of relief for some of <code>C</code>&rsquo;s major pain points, with handy built-in data structures, endian types, and pleasant enum printing.</p>
<p>For prototyping, having hashmaps, dynamic arrays, and generics on hand is a major timesaver, for binary format parsers, endian-types are a big clarity win, I can define the format as-is, rather than manually swapping endianness after parsing, and for debugging, tests, and error handling, enum printing saves me mountains of <code>xmacro</code>-wrapped enums and printer-helpers.</p>
<p>Q: And now you&rsquo;re using it to develop a very impressive piece of kit. Can you tell us something about what prompted you to write <code>spall</code>, and why Odin was the right fit?</p>
<p>A: <code>Spall</code> was written on a whim. <a href=https://handmade.network/m/bvisness>Ben Visness of Handmade Network</a> fame asked around for a replacement for the soon-to-be-deprecated <code>chrome://tracing</code>, and I thought it sounded like a fun little project to tackle. <code>chrome://tracing</code> is a browser-based profiler, so I had to play on its terms (at least to start). I chose Odin because it had reasonable <a href=https://webassembly.org>WASM</a> support, and was relatively painless to get up and running (after knocking out a few little issues here or there). Odin&rsquo;s custom allocator support turned out to be a <em>critical</em> feature, making spall fast and lightweight with WASM&rsquo;s low-memory footprint, high allocation-cost constraints.</p>
<p>Q: You&rsquo;ve run into some problems with WASM as a target, namely memory limits and file I/O. Is there something Odin can do here, or are these inherent platform-specific issues?</p>
<p>A: Sure! WASM does have some frustrating constraints, and Odin definitely isn&rsquo;t perfect.</p>
<p>There&rsquo;s a decent chunk of things that are fixable!</p>
<p>Odin doesn&rsquo;t yet provide a default allocator for WASM, so you have to write your own on top of the wasm page-alloc intrinsic, which is a bit of a painful newbie-hurdle.</p>
<p>Odin doesn&rsquo;t enable the LLVM <code>-bulk-memory target</code> flag by default, so <code>memcpy</code> and <code>memmove</code>, which Odin uses heavily to do 0-initialization of memory/structs (a lovely feature), end up quite expensive unless you know to enable the flag.</p>
<p><code>wasm32</code> (the stable one) is 32-bit platform in a 64-bit world. Odin uses signed integers that are pointer-width (32-bit on wasm32) for slice indexing to try to help users catch underflow errors. Unfortunately, WASM, unlike many 32-bit platforms, gives you access to all 4 GB of the address space, which means that you have to deliberately disable bounds-checking and replace parts of <a href=https://pkg.odin-lang.org/core/mem/>core:mem</a> in order to work with the full address space, and it still doesn&rsquo;t quite work.</p>
<p>And, of course a lot of things that Odin can&rsquo;t really fix, mostly related to memory.</p>
<p>Odin&rsquo;s new map is amazing for native code, but on platforms like WASM where you don&rsquo;t have the ability to free memory back to the OS, it is a major source of fragmentation.</p>
<p>Odin&rsquo;s datastructures can&rsquo;t handle getting close to the memory cap well. When dealing with dynamic arrays on a system like WASM with a hard memory cap and no virtual address space, you can quickly run out of space when they grow and double beyond your available space. Unfortunately, WASM doesn&rsquo;t make that one easy to correct for, there&rsquo;s no good way to know how much memory you can use ahead of time, so you can just run out of memory without warning and be up the creek without a paddle.</p>
<p>Hopefully WASM&rsquo;s memory model will get a little more sane in the coming years.</p>
<p>Q: What would you say your favorite thing about Odin is, and what would you say could be improved? This could be a feature, syntax, the community, documentation, tooling, anything and everything related to working with Odin that you really like and think could use some love, respectively, and why?</p>
<p>A: My favorite thing about Odin is multiple return for functions! Coming from the C space, I love that I can finally make error handling consistent across functions. No more checking for return signedness/zero-ness, or a random passed-in pointer. I just pass the error back and move on.</p>
<p>The biggest Odin pain point in my mind is documentation, for sure. There&rsquo;s so much in the language that still needs a little more explanatory love. There are a few hidden pitfalls with things like the current temp allocator, <code>bit_set</code>s, and a bunch of features like <code>cap()</code> for dynamic arrays that only get mentioned in passing that could use a little more attention. It&rsquo;s an active work-in-progress, I&rsquo;m confident it will get better as we go along.</p>
<p>Q: Back to spall, how is the desktop version coming along and where can we learn more about this exciting new tool?</p>
<p>A: I&rsquo;ve made decent headway on the desktop version! I&rsquo;ve currently got it running on OSX, Windows, and Linux, Odin made it pretty trivial to port all of the crunchy application code.</p>
<p>I&rsquo;ve got it working almost as well as the web-version, it runs about ~2-3x faster, and it allows you to allocate with as much memory as you have, which is a huge upgrade. I&rsquo;m deep in platform-layer code at this point. SDL doesn&rsquo;t do smooth window resizing, file open dialogs, or smooth-scrolling well, so I&rsquo;ve got a pile of work to do, polishing the rough edges and making it feel like a well-made native app everywhere you might want to use it.</p>
<p>If you&rsquo;ve got a project you want to profile and want to get started with the web version of spall, it&rsquo;s free and available on <a href=https://gravitymoth.com/spall>https://gravitymoth.com/spall</a>. The web version is MIT-licensed, and available on <a href=https://github.com/colrdavidson/spall>https://github.com/colrdavidson/spall</a> if you want to read the code or grab the single-file C header library and integrate it into your system.</p>
<p>Hopefully I&rsquo;ll have a release of the native version up for sale on <a href=https://itch.io>itch.io</a> in the next month or two for those who need to profile big projects or want a few more little convenience features.</p>
<p>Q: Was there anything you wanted to say about Odin or spall in addition to this? Any sage advice to newcomers to the language?</p>
<p>A: The community is very responsive, and happy to answer questions if you run into issues! I highly encourage newbies to check out the discord, and ask questions when they run into problems with the language. It helps us a ton, figuring out where the documentation needs the most work, and if it gets you unstuck and on the road to a happy Odin user, it&rsquo;s a major win-win.</p>
</div>
</article>
<div id=TOC class="col-lg-2 odin-toc-border">
<div class="sticky-top odin-below-navbar py-3">
<nav id=TableOfContents>
<ul>
<li><a href=#release-note-highlights>Release note highlights</a></li>
<li><a href=#interview-with-cloin-author-of-spall>Interview with Cloin, author of spall</a></li>
</ul>
</nav>
</div>
</div>
</div>
</div>
</main>
<footer class=odin-footer>
<div class="container pb-5 pt-5">
<div class="row g-4">
<div class=col>
<a class=navbar-brand href=/>
<img class=mb-3 src=/logo.svg height=30 alt=Odin></a>
<p>
The Data-Oriented Language for Sane Software Development.
</p>
</div>
<nav class=col-md-auto>
<h4 class=fw-normal>Resources</h4>
<ul class=list-unstyled>
<li><a href=/docs class=link-light>Docs</a></li>
<li><a href=https://pkg.odin-lang.org/ class=link-light>Packages</a></li>
<li><a href=/news class=link-light>News</a></li>
</ul>
</nav>
<nav class=col-md-auto>
<h4 class=fw-normal>Community</h4>
<ul class=list-unstyled>
<li><a href=https://github.com/odin-lang/Odin target=_blank class=link-light>GitHub</a></li>
<li><a href=https://discord.com/invite/sVBPHEv target=_blank class=link-light>Discord</a></li>
<li><a href=https://www.twitch.tv/ginger_bill target=_blank class=link-light>Twitch</a></li>
<li><a href=https://www.youtube.com/channel/UCUSck1dOH7VKmG4lRW7tZXg target=_blank class=link-light>YouTube</a></li>
<li><a href=/showcase target=_blank class=link-light>Showcase</a></li>
</ul>
</nav>
<nav class=col-md-auto>
<h4 class=fw-normal>Contribute</h4>
<ul class=list-unstyled>
<li><a href=https://github.com/odin-lang/Odin/issues target=_blank class=link-light>Issues</a></li>
<li><a href=https://www.patreon.com/gingerbill target=_blank class=link-light>Donate</a></li>
</ul>
</nav>
</div>
<div class="mt-4 text-muted">© 2016–2024 Ginger Bill</div>
</div>
</footer>
<script src=/lib/bootstrap/js/bootstrap.min.js></script>
<script src=/js/script.js></script>
</body>
</html>